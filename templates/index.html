<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAMANG TECH V5.0 ULTRA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #020617; --neon: #22d3ee; --shadow: #f472b6; --accent: #f59e0b; }
        body { background: var(--bg); color: #f8fafc; font-family: 'Rajdhani'; background-image: radial-gradient(circle, #0f172a 0%, #020617 100%); min-height: 100vh; }
        .glass { background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .neon-text { font-family: 'Orbitron'; background: linear-gradient(to right, var(--neon), #818cf8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; }
        .label-tech { font-size: 0.65rem; text-transform: uppercase; color: #94a3b8; letter-spacing: 2px; font-weight: 700; display: block; margin-bottom: 5px; }
        .box-core { background: linear-gradient(135deg, rgba(34, 211, 238, 0.1), rgba(0,0,0,0.4)); border: 1px solid var(--neon); border-radius: 12px; padding: 15px; }
        .box-shadow { background: linear-gradient(135deg, rgba(244, 114, 182, 0.1), rgba(0,0,0,0.4)); border: 1px solid var(--shadow); border-radius: 12px; padding: 15px; }
        .num-main { font-family: 'Orbitron'; font-size: 1.8rem; color: #fff; letter-spacing: 3px; text-shadow: 0 0 10px var(--neon); }
        .num-shadow { font-family: 'Orbitron'; font-size: 1.5rem; color: #fff; letter-spacing: 3px; text-shadow: 0 0 10px var(--shadow); }
        .btn-run { background: linear-gradient(135deg, #0891b2, #4f46e5); border: none; color: white; font-weight: bold; padding: 12px; border-radius: 10px; width: 100%; transition: 0.3s; font-family: 'Orbitron'; font-size: 0.9rem; }
        .btn-run:hover { box-shadow: 0 0 20px var(--neon); transform: translateY(-2px); }
        .data-info { font-size: 0.8rem; color: #64748b; }
    </style>
</head>
<body>

<div class="container py-4">
    <div class="text-center mb-4">
        <h1 class="neon-text">MAMANG TECH <span style="font-size: 0.5em; vertical-align: middle;">V5.0</span></h1>
        <p class="data-info">CORE & SHADOW ANALYTICS SYSTEM</p>
    </div>

    {% if not logged_in %}
    <div class="col-md-4 mx-auto glass text-center">
        <input type="password" id="key" class="form-control bg-dark text-white border-0 mb-3 text-center" placeholder="ENTER LICENSE">
        <button class="btn btn-run" onclick="login()">AUTHENTICATE</button>
    </div>
    {% else %}
    <div class="col-md-6 mx-auto">
        <div class="glass mb-3">
            <label class="label-tech">SELECT SERVER MARKET</label>
            <select id="market" class="form-select bg-dark text-white border-0 mb-3">
                {% for m in markets %}<option value="{{m}}">{{m}}</option>{% endfor %}
            </select>
            <button class="btn btn-run" onclick="run()" id="btnGo">START DEEP ANALYSIS</button>
        </div>

        <div id="resultArea" style="display:none;">
            <div class="glass mb-3 border-info">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div>
                        <h4 id="vMarket" class="neon-text mb-0"></h4>
                        <span id="vMethod" class="data-info" style="color:var(--neon)"></span>
                    </div>
                    <div class="text-end">
                        <span class="label-tech">DAILY / WEEKLY</span>
                        <div class="text-white small"><span id="vLast"></span> / <span id="vWeekly"></span></div>
                    </div>
                </div>

                <div class="box-core mb-3 text-center">
                    <span class="label-tech" style="color: var(--neon);">CORE 2D INVEST (BOM UTAMA)</span>
                    <div id="vCore" class="num-main"></div>
                </div>

                <div class="box-shadow mb-3 text-center">
                    <span class="label-tech" style="color: var(--shadow);">SHADOW 2D (CADANGAN / JAGA-JAGA)</span>
                    <div id="vShadow" class="num-shadow text-secondary"></div>
                </div>

                <div class="p-2 bg-black rounded border border-secondary text-center">
                    <span class="label-tech" style="color: var(--accent);">BBFS ASURANSI (5-DIGIT)</span>
                    <div id="vBbfs" class="fs-4 fw-bold text-warning" style="letter-spacing: 5px; font-family: 'Orbitron';"></div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    function login() { $.post('/login', {key:$('#key').val()}, (d) => location.reload()); }
    function run() {
        const btn = $('#btnGo');
        btn.prop('disabled', true).text('SCRAPING DATA...');
        $.post('/analyze', {market: $('#market').val()}, (d) => {
            btn.prop('disabled', false).text('START DEEP ANALYSIS');
            if(d.error) { alert(d.error); return; }
            
            $('#vMarket').text(d.market);
            $('#vMethod').text(d.method);
            $('#vLast').text(d.last);
            $('#vWeekly').text(d.weekly);
            $('#vCore').text(d.core_2d);
            $('#vShadow').text(d.shadow_2d);
            $('#vBbfs').text(d.bbfs);
            
            $('#resultArea').fadeIn();
        });
    }
</script>
</body>
</html>
